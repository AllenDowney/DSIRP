
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generators and Iterators &#8212; Data Structures and Information Retrieval in Python</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sets" href="set.html" />
    <link rel="prev" title="Quiz 1" href="quiz01.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Data Structures and Information Retrieval in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Outline
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="algorithms.html">
   Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analysis.html">
   Analysis of Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="timing.html">
   Testing Order of Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz01.html">
   Quiz 1
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Generators and Iterators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="set.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="recursion.html">
   Recursion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz02.html">
   Quiz 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dfs.html">
   Depth First Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="search2.html">
   Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hashmap.html">
   Implementing Mapping Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz03.html">
   Quiz 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heap.html">
   Priority Queues and Heaps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="huffman.html">
   Huffman Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="philosophy.html">
   Getting to Philosophy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz04.html">
   Quiz 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="redis.html">
   Redis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linked_list.html">
   Linked List
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexer.html">
   Indexer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz05.html">
   Quiz 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deque.html">
   Deque
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="level_order.html">
   Level Order Traversal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bfs.html">
   Breadth First Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="graph.html">
   Graphs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz06.html">
   Quiz 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="crawler.html">
   Crawler
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mergesort.html">
   Merge Sort
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fft.html">
   FFT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz07.html">
   Quiz 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pagerank.html">
   PageRank
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/generator.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AllenDowney/DSIRP"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AllenDowney/DSIRP/master?urlpath=tree/generator.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generators">
   Generators
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#itertools">
   itertools
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#enumerating-all-pairs">
   Enumerating all pairs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#permutations">
   Permutations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combinations">
   Combinations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-hands">
   Generating hands
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-many-flushes">
   How many flushes?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#write-your-own-product">
   Write your own product
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="generators-and-iterators">
<h1>Generators and Iterators<a class="headerlink" href="#generators-and-iterators" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/DSIRP/blob/main/chapters/generator.ipynb">Click here to run this chapter on Colab</a></p>
<p>This chapter introduces generator functions, which are functions that yield a stream of values, rather than returning a single value.</p>
<p>To demonstrate their use, we’ll explore Cartesian products, permutations, and combinations, using playing cards as an example.</p>
<div class="section" id="generators">
<h2>Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we’ll write a generator function that generates the playing cards in a standard 52-card deck.
This example is inspired by an example in Peter Norvig’s <a class="reference external" href="https://nbviewer.ipython.org/url/norvig.com/ipython/Probability.ipynb">“A Concrete Introduction to Probability (using Python)”</a>.</p>
<p>Here are Unicode strings that represent the set of suits and the set of ranks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">suits</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;♠♥♦♣&#39;</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;AKQJ⑽98765432&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s a nested for loop that enumerates all pairings of a rank with a suit.</p>
<p>This set of pairs is the <a class="reference external" href="https://en.wikipedia.org/wiki/Cartesian_product">Cartesian product</a> of the set of ranks and the set of suits.</p>
<p>The following function encapsulates the loops and uses the <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement to generate a stream of cards.</p>
<p>Because this function includes a <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement, it is a generator function. When we call it, the return value is a generator object.</p>
<p>The generator object is iterable, so we can use <code class="docutils literal notranslate"><span class="pre">next</span></code> to get the first element of the stream.</p>
<p>The first time we call <code class="docutils literal notranslate"><span class="pre">next</span></code>, the function runs until it hits the <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement.
If we call <code class="docutils literal notranslate"><span class="pre">next</span></code> again, the function resumes from where it left off and runs until it hits the <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement again.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">it</span></code> is iterable, we can use it in a for loop to enumerate the remaining pairs.</p>
<p>When the flow of control reaches the end of the function, the generator object raises and exception, which causes the for loop to end.</p>
</div>
<div class="section" id="itertools">
<h2>itertools<a class="headerlink" href="#itertools" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">itertools</span></code> library provides function for working with iterators, including <code class="docutils literal notranslate"><span class="pre">product</span></code>, which is a generator function that takes iterators as arguments at yields their Cartesian product.
We’ll use <code class="docutils literal notranslate"><span class="pre">itertools.product</span></code> in the next few sections; then we’ll see how to implement it.</p>
<p>Here’s a loop that uses <code class="docutils literal notranslate"><span class="pre">itertools.product</span></code> to generate the playing cards again.</p>
<p><strong>Exercise:</strong> Encapsulate the previous loop in a generator function called <code class="docutils literal notranslate"><span class="pre">card_generator2</span></code> that yields the playing  cards. Then call your function and use it to print the cards.</p>
</div>
<div class="section" id="enumerating-all-pairs">
<h2>Enumerating all pairs<a class="headerlink" href="#enumerating-all-pairs" title="Permalink to this headline">¶</a></h2>
<p>Now that we have playing cards, let’s deal a few hands. In fact, let’s deal all the hands.</p>
<p>First, I’ll create two card generators.</p>
<p>Now we can use <code class="docutils literal notranslate"><span class="pre">product</span></code> to generate all pairs of cards.</p>
<p>To check whether it’s working correctly, it will be useful to count the number of elements in an iterator, which is what <code class="docutils literal notranslate"><span class="pre">ilen</span></code> does.
This idiom is discussed <a class="reference external" href="https://stackoverflow.com/questions/390852/is-there-any-built-in-way-to-get-the-length-of-an-iterable-in-python">on Stack Overflow</a>.</p>
<p>Now we can use it to count the pairs of cards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it1</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">it2</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">ilen</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>If things have gone according to plan, the number of pairs should be <span class="math notranslate nohighlight">\(52^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">52</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that we have to create new card iterators every time, because once they are used up, they behave like an empty list.
Here’s what happens if we try to use them again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilen</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>That’s also why we had to create two card iterators.
If you create one and try to use it twice, it doesn’t work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">ilen</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">it</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>However, you can get around this limitation by calling <code class="docutils literal notranslate"><span class="pre">product</span></code> with the <code class="docutils literal notranslate"><span class="pre">repeat</span></code> argument, which makes it possible to use a single iterator to generate a Cartesian product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">ilen</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="permutations">
<h2>Permutations<a class="headerlink" href="#permutations" title="Permalink to this headline">¶</a></h2>
<p>In the previous section, you might have noticed that some of the hands we generated are impossible because they contain the same card more than once.</p>
<p>One way to solve this problem is to generate all pairs and then eliminate the ones that contain duplicates.</p>
<p><strong>Exercise:</strong> Write a generator function called <code class="docutils literal notranslate"><span class="pre">permutations</span></code> that takes an iterator and and integer, <code class="docutils literal notranslate"><span class="pre">r</span></code>, as arguments. It should generate tuples that represent all subsets of the elements in the iterator with size <code class="docutils literal notranslate"><span class="pre">r</span></code> and no duplicates.</p>
<p>Test your function by generating and printing all hands with two distinct cards.
Then use <code class="docutils literal notranslate"><span class="pre">ilen</span></code> to count how many there are, and confirm that it’s <code class="docutils literal notranslate"><span class="pre">52</span> <span class="pre">*</span> <span class="pre">51</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">itertools</span></code> library provides a function called <code class="docutils literal notranslate"><span class="pre">permutations</span></code> that does the same thing.</p>
</div>
<div class="section" id="combinations">
<h2>Combinations<a class="headerlink" href="#combinations" title="Permalink to this headline">¶</a></h2>
<p>At this point we are generating legitimate hands in the sense that the same card never appears twice.
But we end up generating the same hand more than once, in the sense that the order of the cards does not matter.
So we consider <code class="docutils literal notranslate"><span class="pre">(card1,</span> <span class="pre">card2)</span></code> to be the same hand as <code class="docutils literal notranslate"><span class="pre">(card2,</span> <span class="pre">card1)</span></code>.
To avoid that, we can generate all permutations and then filter out the ones that are not in sorted order.</p>
<p>It doesn’t really matter which order is considered “sorted”; it’s just a way to choose one ordering we consider “canonical”.</p>
<p>That’s what the following loop does.</p>
<p><strong>Exercise:</strong> Write a generator function called <code class="docutils literal notranslate"><span class="pre">combinations</span></code> that takes an iterator and and integer, <code class="docutils literal notranslate"><span class="pre">r</span></code>, as arguments. It should generate tuples that represent all <em>sorted</em> subsets of the elements in the iterator with size <code class="docutils literal notranslate"><span class="pre">r</span></code> and no duplicates.</p>
<p>Test your function by generating and printing all hands with two distinct cards.
Then use <code class="docutils literal notranslate"><span class="pre">ilen</span></code> to count how many there are, and confirm that it’s <code class="docutils literal notranslate"><span class="pre">52</span> <span class="pre">*</span> <span class="pre">51</span> <span class="pre">/</span> <span class="pre">2</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">itertools</span></code> library provides a function called <code class="docutils literal notranslate"><span class="pre">combinations</span></code> that does the same thing.</p>
</div>
<div class="section" id="generating-hands">
<h2>Generating hands<a class="headerlink" href="#generating-hands" title="Permalink to this headline">¶</a></h2>
<p>We can use <code class="docutils literal notranslate"><span class="pre">combinations</span> </code> to write a generator that yields all valid hands with <code class="docutils literal notranslate"><span class="pre">n</span></code> playing cards, where “valid” means that the cards are in sorted order with no duplicates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilen</span><span class="p">(</span><span class="n">hand_generator</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>If you ever find yourself looping through an iterator and yielding all of the elements, you can simplify the code using <code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilen</span><span class="p">(</span><span class="n">hand_generator</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s see how many hands there are with 3, 4, and (maybe) 5 cards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilen</span><span class="p">(</span><span class="n">hand_generator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilen</span><span class="p">(</span><span class="n">hand_generator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>I’m not patient enough to let this one finish.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ilen(hand_generator(5))</span>
</pre></div>
</div>
</div>
</div>
<p>But if we only care about the number of combinations, we can use <a class="reference external" href="https://docs.python.org/3/library/math.html"><code class="docutils literal notranslate"><span class="pre">math.comb</span></code></a>.</p>
</div>
<div class="section" id="how-many-flushes">
<h2>How many flushes?<a class="headerlink" href="#how-many-flushes" title="Permalink to this headline">¶</a></h2>
<p>In poker, a “flush” is a hand where all cards have the same suit.
To check whether a hand is a flush, it is convenient to extract the suit part of the cards and make a set.</p>
<p><strong>Exercise:</strong> Write a function called <code class="docutils literal notranslate"><span class="pre">is_flush</span></code> that takes a hand as an argument and returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if all cards are the same suit.</p>
<p>Then write a generator function called <code class="docutils literal notranslate"><span class="pre">flush_generator</span></code> that takes an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> and return all hands with <code class="docutils literal notranslate"><span class="pre">n</span></code> cards that are flushes.</p>
<p>What fraction of hands with 3, 4, and 5 cards are flushes?</p>
</div>
<div class="section" id="write-your-own-product">
<h2>Write your own product<a class="headerlink" href="#write-your-own-product" title="Permalink to this headline">¶</a></h2>
<p>So far we’ve been using <code class="docutils literal notranslate"><span class="pre">itertools.product</span></code>, but in the same way we wrote <code class="docutils literal notranslate"><span class="pre">permutations</span></code> and <code class="docutils literal notranslate"><span class="pre">combinations</span></code>, we can write our own <code class="docutils literal notranslate"><span class="pre">product</span></code>.</p>
<p>If there are only two iterators, we can do it with nested <code class="docutils literal notranslate"><span class="pre">for</span></code> loops.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">product2</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">it2</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>So we can generate the cards like this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">product2</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">):</span>
    <span class="n">card</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we might be tempted to write two-card hands like this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it1</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">it2</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hand</span> <span class="ow">in</span> <span class="n">product2</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>But that doesn’t work; it only generates the first 52 pairs.
Before you go on, see if you can figure out why.</p>
<p>We can solve this problem by making each iterator into a tuple; then we can loop through them more than once.
The price we pay is that we have to store all of the elements of the iterators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">product2</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">):</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">it1</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">it2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">t2</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>This version of <code class="docutils literal notranslate"><span class="pre">product2</span></code> works if the arguments are iterators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it1</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">it2</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hand</span> <span class="ow">in</span> <span class="n">product2</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">it1</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>
<span class="n">it2</span> <span class="o">=</span> <span class="n">card_generator</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">suits</span><span class="p">)</span>

<span class="n">ilen</span><span class="p">(</span><span class="n">product2</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">it2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s take it up a notch. What if you want the product of more than two iterators.
The version of <code class="docutils literal notranslate"><span class="pre">product</span></code> we got from <code class="docutils literal notranslate"><span class="pre">itertools</span></code> can handle this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise:</strong> Write a generator function that takes an arbitrary number of iterables and yields their Cartesian product. Compare the results to <code class="docutils literal notranslate"><span class="pre">itertools.product</span></code>.</p>
<p>Hint: I found it easiest to write this recursively.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="quiz01.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Quiz 1</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="set.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Sets</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Allen B. Downey<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>